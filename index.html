<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Cusco Reporta ‚Äì Inicio</title>
  
  <!-- IMPORTANTE: Cargar Supabase primero -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  
  <!-- Tus estilos -->
  <link rel="stylesheet" href="../css/styles.css" />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
</head>

<body>
  <!-- ======= HEADER ======= -->
  <header class="navbar">
    <div class="navbar__left">
      <img src="../assents/images/CuscoReporta.png" alt="Logo Cusco Reporta" class="navbar__logo">
    </div>

    <nav class="navbar__menu">
      <a href="index.html">Inicio</a>
      <a href="registrar_tu_denuncia.html">Registra tu denuncia</a>
      <a href="sobre_nosotros.html">Sobre nosotros</a>
      <a href="iniciar-sesion.html">Iniciar Sesi√≥n</a>
      <a href="ayuda.html">Ayuda</a>
    </nav>
  </header>

  <!-- ======= MAIN ======= -->
  <main class="main">

    <!-- ===== HERO ROJO OSCURO ===== -->
    <section class="hero hero--red">
      <div class="hero__text">
        <h1>Cusco Reporta</h1>
        <p>
          La plataforma ciudadana para reportar infracciones de tr√°nsito y situaciones
          que afectan la seguridad vial en nuestra ciudad.
        </p>
        <a href="registrar_tu_denuncia.html" class="hero__btn">Reportar ahora</a>
      </div>

      <div class="hero__img">
        <img src="../assents/images/traffic_hero.png" alt="Reporte de tr√°nsito">
      </div>
    </section>

    <!-- ===== SECCI√ìN "¬øPOR QU√â USAR CUSCO REPORTA?" ===== -->
    <section class="features">
      <h2>¬øPor qu√© usar Cusco Reporta?</h2>

      <div class="features__grid">

        <div class="feature feature--red">
          <img src="../assents/icons/fast.svg" alt="">
          <h3>F√°cil y r√°pido</h3>
          <p>Registra una denuncia en minutos desde tu celular o computadora.</p>
        </div>

        <div class="feature feature--red">
          <img src="../assents/icons/shield.svg" alt="">
          <h3>Seguro</h3>
          <p>Tus datos est√°n protegidos. Tambi√©n puedes reportar de forma an√≥nima.</p>
        </div>

        <div class="feature feature--red">
          <img src="../assents/icons/impact.svg" alt="">
          <h3>Impacto real</h3>
          <p>Tu reporte contribuye a mejorar la seguridad vial en nuestra ciudad.</p>
        </div>

      </div>
    </section>

    <!-- SECCI√ìN DE PRUEBA (opcional, puedes quitar despu√©s) -->
    <section id="supabase-test" style="display: none; padding: 20px; background: #f5f5f5; margin: 20px; border-radius: 10px;">
      <h3>Prueba de Conexi√≥n Supabase</h3>
      <p id="test-status">Probando conexi√≥n...</p>
      <button onclick="testSupabase()">Probar conexi√≥n manualmente</button>
    </section>

  </main>

  <!-- ORDEN CR√çTICO DE SCRIPTS: -->
  <!-- 1. Supabase config -->
  <script src="../js/supaBase.js" defer></script>
  
  <!-- 2. Script de prueba (opcional) -->
  <script>
    // Script de prueba de conexi√≥n
    async function testSupabase() {
      console.log('üß™ Probando conexi√≥n a Supabase...');
      
      const statusElement = document.getElementById('test-status');
      
      if (!window.supabase || window.supabase._mode === 'error') {
        statusElement.innerHTML = '‚ùå Supabase no est√° configurado. Verifica la consola.';
        statusElement.style.color = 'red';
        return;
      }
      
      try {
        statusElement.innerHTML = 'üîÑ Conectando...';
        statusElement.style.color = 'orange';
        
        // Probar autenticaci√≥n
        const { data: sessionData, error: sessionError } = await window.supabase.auth.getSession();
        
        if (sessionError) {
          statusElement.innerHTML = `‚ö†Ô∏è Error sesi√≥n: ${sessionError.message}`;
          statusElement.style.color = 'orange';
        } else {
          // Probar consulta a la base de datos
          const { data, error } = await window.supabase
            .from('denuncias')
            .select('id, titulo, estado')
            .limit(3);
            
          if (error) {
            statusElement.innerHTML = `‚ùå Error BD: ${error.message}`;
            statusElement.style.color = 'red';
            console.error('Error detallado:', error);
          } else {
            const sessionMsg = sessionData.session ? '‚úÖ Sesi√≥n activa' : '‚ÑπÔ∏è Sin sesi√≥n activa';
            const dataMsg = data ? `‚úÖ ${data.length} denuncias obtenidas` : '‚úÖ Conexi√≥n exitosa';
            statusElement.innerHTML = `${sessionMsg}<br>${dataMsg}`;
            statusElement.style.color = 'green';
            
            if (data && data.length > 0) {
              console.log('üìä Datos de ejemplo:', data);
            }
          }
        }
      } catch (err) {
        statusElement.innerHTML = `‚ùå Error inesperado: ${err.message}`;
        statusElement.style.color = 'red';
        console.error('Error completo:', err);
      }
    }
    
    // Probar autom√°ticamente al cargar
    document.addEventListener('DOMContentLoaded', () => {
      setTimeout(testSupabase, 2000); // Esperar a que cargue Supabase
    });
  </script>
  
  <!-- 3. Tu main.js -->
  <script src="../js/main.js" defer></script>
</body>
</html>
